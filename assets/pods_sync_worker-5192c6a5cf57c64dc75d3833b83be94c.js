("function"==typeof define?function(t){define("msgpack-js",t)}:"object"==typeof exports?function(t){module.exports=t()}:function(t){this.msgpack=t()})(function(){"use strict";function t(t){if(void 0===t)return"undefined";var e,r;if(t instanceof ArrayBuffer?(r="ArrayBuffer",e=new DataView(t)):t instanceof DataView&&(r="DataView",e=t),!e)return JSON.stringify(t);for(var i=[],n=0;n<t.byteLength;n++){if(n>20){i.push("...");break}var s=e.getUint8(n).toString(16);1===s.length&&(s="0"+s),i.push(s)}return"<"+r+" "+i.join(" ")+">"}function e(t,e,r){for(var i=(t.byteLength,0),n=r.length;n>i;i++){var s=r.charCodeAt(i);if(128>s)t.setUint8(e++,s>>>0&127|0);else if(2048>s)t.setUint8(e++,s>>>6&31|192),t.setUint8(e++,s>>>0&63|128);else if(65536>s)t.setUint8(e++,s>>>12&15|224),t.setUint8(e++,s>>>6&63|128),t.setUint8(e++,s>>>0&63|128);else{if(!(1114112>s))throw new Error("bad codepoint "+s);t.setUint8(e++,s>>>18&7|240),t.setUint8(e++,s>>>12&63|128),t.setUint8(e++,s>>>6&63|128),t.setUint8(e++,s>>>0&63|128)}}}function r(t,e,r){for(var i="",n=e,s=e+r;s>n;n++){var o=t.getUint8(n);if(0!==(128&o))if(192!==(224&o))if(224!==(240&o)){if(240!==(248&o))throw new Error("Invalid byte "+o.toString(16));i+=String.fromCharCode((7&o)<<18|(63&t.getUint8(++n))<<12|(63&t.getUint8(++n))<<6|(63&t.getUint8(++n))<<0)}else i+=String.fromCharCode((15&o)<<12|(63&t.getUint8(++n))<<6|(63&t.getUint8(++n))<<0);else i+=String.fromCharCode((15&o)<<6|63&t.getUint8(++n));else i+=String.fromCharCode(o)}return i}function i(t){for(var e=0,r=0,i=t.length;i>r;r++){var n=t.charCodeAt(r);if(128>n)e+=1;else if(2048>n)e+=2;else if(65536>n)e+=3;else{if(!(1114112>n))throw new Error("bad codepoint "+n);e+=4}}return e}function n(t,e){this.offset=e||0,this.view=t}function s(t){var e=new DataView(t),r=new n(e),i=r.parse();if(r.offset!==t.byteLength)throw new Error(t.byteLength-r.offset+" trailing bytes");return i}function o(t,r,n){var s=typeof t;if("string"===s){var f=i(t);if(32>f)return r.setUint8(n,160|f),e(r,n+1,t),1+f;if(65536>f)return r.setUint8(n,218),r.setUint16(n+1,f),e(r,n+3,t),3+f;if(4294967296>f)return r.setUint8(n,219),r.setUint32(n+1,f),e(r,n+5,t),5+f}if(t instanceof ArrayBuffer){var f=t.byteLength;if(65536>f)return r.setUint8(n,216),r.setUint16(n+1,f),new Uint8Array(r.buffer).set(new Uint8Array(t),n+3),3+f;if(4294967296>f)return r.setUint8(n,217),r.setUint32(n+1,f),new Uint8Array(r.buffer).set(new Uint8Array(t),n+5),5+f}if("number"===s){if(t<<0!==t)return r.setUint8(n,203),r.setFloat64(n+1,t),9;if(t>=0){if(128>t)return r.setUint8(n,t),1;if(256>t)return r.setUint8(n,204),r.setUint8(n+1,t),2;if(65536>t)return r.setUint8(n,205),r.setUint16(n+1,t),3;if(4294967296>t)return r.setUint8(n,206),r.setUint32(n+1,t),5;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return r.setInt8(n,t),1;if(t>=-128)return r.setUint8(n,208),r.setInt8(n+1,t),2;if(t>=-32768)return r.setUint8(n,209),r.setInt16(n+1,t),3;if(t>=-2147483648)return r.setUint8(n,210),r.setInt32(n+1,t),5;throw new Error("Number too small -0x"+(-t).toString(16).substr(1))}if("undefined"===s)return r.setUint8(n,196),1;if(null===t)return r.setUint8(n,192),1;if("boolean"===s)return r.setUint8(n,t?195:194),1;if("object"===s){var f,a=0,h=Array.isArray(t);if(h)f=t.length;else{var u=Object.keys(t);f=u.length}var a;if(16>f?(r.setUint8(n,f|(h?144:128)),a=1):65536>f?(r.setUint8(n,h?220:222),r.setUint16(n+1,f),a=3):4294967296>f&&(r.setUint8(n,h?221:223),r.setUint32(n+1,f),a=5),h)for(var d=0;f>d;d++)a+=o(t[d],r,n+a);else for(var d=0;f>d;d++){var c=u[d];a+=o(c,r,n+a),a+=o(t[c],r,n+a)}return a}throw new Error("Unknown type "+s)}function f(t){var e=typeof t;if("string"===e){var r=i(t);if(32>r)return 1+r;if(65536>r)return 3+r;if(4294967296>r)return 5+r}if(t instanceof ArrayBuffer){var r=t.byteLength;if(65536>r)return 3+r;if(4294967296>r)return 5+r}if("number"===e){if(t<<0!==t)return 9;if(t>=0){if(128>t)return 1;if(256>t)return 2;if(65536>t)return 3;if(4294967296>t)return 5;if(0x10000000000000000>t)return 9;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-2147483648)return 5;if(t>=-0x8000000000000000)return 9;throw new Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===e||"undefined"===e||null===t)return 1;if("object"===e){var r,n=0;if(Array.isArray(t)){r=t.length;for(var s=0;r>s;s++)n+=f(t[s])}else{var o=Object.keys(t);r=o.length;for(var s=0;r>s;s++){var a=o[s];n+=f(a)+f(t[a])}}if(16>r)return 1+n;if(65536>r)return 3+n;if(4294967296>r)return 5+n;throw new Error("Array or object too long 0x"+r.toString(16))}throw new Error("Unknown type "+e)}var a={};return a.inspect=t,a.utf8Write=e,a.utf8Read=r,a.utf8ByteCount=i,a.encode=function(t){var e=new ArrayBuffer(f(t)),r=new DataView(e);return o(t,r,0),e},a.decode=s,n.prototype.map=function(t){for(var e={},r=0;t>r;r++){var i=this.parse();e[i]=this.parse()}return e},n.prototype.buf=function(t){var e=new ArrayBuffer(t);return new Uint8Array(e).set(new Uint8Array(this.view.buffer,this.offset,t),0),this.offset+=t,e},n.prototype.raw=function(t){var e=r(this.view,this.offset,t);return this.offset+=t,e},n.prototype.array=function(t){for(var e=new Array(t),r=0;t>r;r++)e[r]=this.parse();return e},n.prototype.parse=function(){var t,e,r=this.view.getUint8(this.offset);if(160===(224&r))return e=31&r,this.offset++,this.raw(e);if(128===(240&r))return e=15&r,this.offset++,this.map(e);if(144===(240&r))return e=15&r,this.offset++,this.array(e);if(0===(128&r))return this.offset++,r;if(224===(224&r))return t=this.view.getInt8(this.offset),this.offset++,t;switch(r){case 218:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.raw(e);case 219:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.raw(e);case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return this.offset++,void 0;case 204:return t=this.view.getUint8(this.offset+1),this.offset+=2,t;case 205:return t=this.view.getUint16(this.offset+1),this.offset+=3,t;case 206:return t=this.view.getUint32(this.offset+1),this.offset+=5,t;case 208:return t=this.view.getInt8(this.offset+1),this.offset+=2,t;case 209:return t=this.view.getInt16(this.offset+1),this.offset+=3,t;case 210:return t=this.view.getInt32(this.offset+1),this.offset+=5,t;case 222:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.map(e);case 223:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.map(e);case 220:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.array(e);case 221:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.array(e);case 216:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.buf(e);case 217:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.buf(e);case 202:return t=this.view.getFloat32(this.offset+1),this.offset+=5,t;case 203:return t=this.view.getFloat64(this.offset+1),this.offset+=9,t}throw new Error("Unknown type 0x"+r.toString(16))},a}),function(){var t=[].slice;this.Logger=function(){function e(t,e){this.level=e,this.env=t;try{this.console=console}catch(r){}}return e.prototype.levels={error:0,warn:1,info:2,verbose:3},e.prototype.error=function(){var e;return e=1<=arguments.length?t.call(arguments,0):[],this.log.apply(this,["error"].concat(t.call(e)))},e.prototype.warn=function(){var e;return e=1<=arguments.length?t.call(arguments,0):[],this.log.apply(this,["warn"].concat(t.call(e)))},e.prototype.info=function(){var e;return e=1<=arguments.length?t.call(arguments,0):[],this.log.apply(this,["info"].concat(t.call(e)))},e.prototype.verbose=function(){var e;return e=1<=arguments.length?t.call(arguments,0):[],this.log.apply(this,["verbose"].concat(t.call(e)))},e.prototype.log=function(){var e,r,i;return e=arguments[0],i=2<=arguments.length?t.call(arguments,1):[],this.levels[e]<=this.levels[this.level]&&this.console&&this.console.log?(r=[new Date,this.env].concat(i),this.console.log(r.join(" "))):void 0},e}()}.call(this),function(){this.PodsLoader=function(){function t(t,e){this.seedsURL=t,this.chunk_index=e}return t.prototype.delegate=null,t.prototype.requests=[],t.prototype.running=0,t.prototype.finished=0,t.prototype.progress=function(){return this.finished/(this.finished+this.running)},t.prototype.cancel=function(){var t,e,r,i;for(i=this.requests,e=0,r=i.length;r>e;e++)t=i[e],t.abort();return this.requests=[],this.running=0,this.finished=0},t.prototype.loadPods=function(){var t,e,r,i,n;for(this.cancel(),i=this.chunk_index,n=[],e=0,r=i.length;r>e;e++)t=i[e],n.push(this.loadPodsChunk(t[0]));return n},t.prototype.loadPodsChunk=function(t){var e,r;return e=this,r=new XMLHttpRequest,r.open("GET",this.seedsURL+"/pods/"+t+".mpac",!0),r.responseType="arraybuffer",r.onload=function(){var r;return r=msgpack.decode(this.response),e.podsChunkDidLoad(t,r)},r.send(),this.requests.push(r),this.running+=1},t.prototype.podsChunkDidLoad=function(t,e){return this.running-=1,this.finished+=1,this.delegate&&(this.delegate.didLoad&&this.delegate.didLoad(t,e),this.delegate.didLoadAll&&1===this.progress())?this.delegate.didLoadAll():void 0},t}()}.call(this),function(){}.call(this),function(){this.PodsLoaderWorker=function(){function t(t,e){this.logger=e,this.worker=t,this.worker.onmessage=function(t){return function(e){return t.onmessage(e)}}(this)}return t.prototype.onmessage=function(t){var e;return e=t.data.command,this.logger.verbose("PodsLoaderWorker.onmessage command",e),"init"===e?this.initLoader(t.data.seedsURL,t.data.index):"reload"===e?this.reload():void 0},t.prototype.initLoader=function(t,e){return this.podsLoader=new PodsLoader(t,e),this.podsLoader.delegate=this},t.prototype.reload=function(){return this.podsLoader?this.podsLoader.loadPods():void 0},t.prototype.didLoad=function(t,e){return this.logger.verbose("PodsLoaderWorker.didLoad",t),this.worker.postMessage({command:"didLoad",id:t,pods:e,progress:this.podsLoader.progress()})},t.prototype.didLoadAll=function(){return this.logger.verbose("PodsLoaderWorker.didLoadAll"),this.worker.postMessage({command:"didLoadAll"})},t}()}.call(this),function(){var t,e;t=new Logger("app","info"),e=new PodsLoaderWorker(this,t),this.postMessage({command:"ready"})}.call(this);